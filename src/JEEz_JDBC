package com.sdzee.bdd;

import java.util.ArrayList;
import java.util.List;

import javax.servlet.http.HttpServletRequest;

public class JEEz_JDBC {

    /* On créé une liste qui contient tous les résultats de nos tests */
    private List<String> messages = new ArrayList<String>();



    /*
    RENVOI LES JEUX DISPONIBLES AUX JOUEURS
     */
    public List<String> playableGame(HttpServelRequest request) {

        /*  Chargement du driver pour la BDD */
        try {
            Class.forName("com.mysql.jdbc.Driver");
        }
        catch (ClassNotFoundException e) {
                    + e.getMessage());
        }
        /*
            on remplit les informations pour l'url et l'utilisateur de la BDD
         */
        String url = "jdbc:mysql://localhost:3306/mydb";  //seulement le pc de Louis a la BDD pour le moment
        String utilisateur = "root"; //identifiant user bdd
        String motDePasse = "1234"; //mdp user bdd
        /*
        On initialise ce qui va nous servir pour communiquer avec la BDD
         */
        try {
            Connection connexion = DriverManager.getConnection(url, utilisateur, motDePasse);
            CallableStatement req = connexion.prepareCall({"playable_Game"});
            Resulset resultat = req.execute();
            /* Exécution d'une requête de lecture */
            while ( resultat.next() ) {
                messages.add(resultat.getString("nom"));
            }
            resultat.close();
            req.close();
            connexion.close();
        } catch ( SQLException e ) {
        messages.add( "Erreur lors de la connexion : <br/>"
                + e.getMessage() );
        }
        return message;
    }
/*
RENVOI LA LISTE DES JOUEURS QUI

 */
    public  List<Play> currentPlay(HttpServelRequest request) {

        /*  Chargement du driver pour la BDD */
        try {
            Class.forName("com.mysql.jdbc.Driver");
        }
        catch (ClassNotFoundException e) {
            + e.getMessage());
        }
        /*
            on remplit les informations pour l'url et l'utilisateur de la BDD
         */
        String url = "jdbc:mysql://localhost:3306/mydb";  //seulement le pc de Louis a la BDD pour le moment
        String utilisateur = "root"; //identifiant user bdd
        String motDePasse = "1234"; //mdp user bdd
        /*
        On initialise ce qui va nous servir pour communiquer avec la BDD
         */
        try {
            Connection connexion = DriverManager.getConnection(url, utilisateur, motDePasse);
            Statement req = connexion.statement("SELECT * FROM Play where endDate = null");
            Resulset resultat = req.execute();
            /* Exécution d'une requête de lecture */
            while ( resultat.next() ) {
                Play partie = new Play();
                Play.idPartie=resultat.getInt(1);
                Play.start=resultat.getDate(2);
                Play.



            }
            resultat.close();
            req.close();
            connexion.close();
        } catch ( SQLException e ) {
            messages.add( "Erreur lors de la connexion : <br/>"
                    + e.getMessage() );
        }
        return message;
    }




/*
    public List<String> executerTests(HttpServletRequest request ) {

        /* Chargement du driver JDBC pour MySQL */
        /*try {
            messages.add( "Chargement du driver..." );
            Class.forName( "com.mysql.jdbc.Driver" );
            messages.add( "Driver chargé !" );
        } catch ( ClassNotFoundException e ) {
            messages.add( "Erreur lors du chargement : le driver n'a pas été trouvé dans le classpath ! <br/>"
                    + e.getMessage() );
        }
        /* Connexion à la base de données */
    /*    String url = "jdbc:mysql://localhost:3306/mydb";  //seulement le pc de Louis a la BDD pour le moment
        String utilisateur = "root"; //identifiant user bdd
        String motDePasse = "1234"; //mdp user bdd

        Connection connexion = null;
        Statement statement = null;
        ResultSet resultat = null;

        try {
            connexion = DriverManager.getConnection( url, utilisateur, motDePasse );

            /* Création de l'objet gérant les requêtes */
        /*    CallableStatement req = connexion.prepareCall({"name_Game"});
            resultat = req.execute();
            resultat = statement.executeQuery( "SELECT * FROM Player" );
            String name
            /* Récupération des données du résultat de la requête de lecture */
           /* while ( resultat.next() ) {
                int idUtilisateur = resultat.getInt( "id" );
                String emailUtilisateur = resultat.getString( "email" );
                String motDePasseUtilisateur = resultat.getString( "mot_de_passe" );
                String nomUtilisateur = resultat.getString( "nom" );
                /* Formatage des données pour affichage dans la JSP finale. */
               /* messages.add( "Données retournées par la requête : id = " + idUtilisateur + ", email = " + emailUtilisateur
                        + ", motdepasse = "
                        + motDePasseUtilisateur + ", nom = " + nomUtilisateur + "." );
            }/*
        */
      /*  } catch ( SQLException e ) {
            messages.add( "Erreur lors de la connexion : <br/>"
                    + e.getMessage() );
        } /*finally {
            messages.add( "Fermeture de l'objet ResultSet." );
            if ( resultat != null ) {
                try {
                    resultat.close();
                } catch ( SQLException ignore ) {
                }
            }
            messages.add( "Fermeture de l'objet Statement." );
            if ( statement != null ) {
                try {
                    statement.close();
                } catch ( SQLException ignore ) {
                }
            }
            messages.add( "Fermeture de l'objet Connection." );
            if ( connexion != null ) {
                try {
                    connexion.close();
                } catch ( SQLException ignore ) {
                }
            }
        }*/
/*
        return messages;*/
    }*/
}